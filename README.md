# ğŸŒ ì§€ê¸ˆ ì—¬í–‰ (NowTrip)

**ì§€ê¸ˆ ì—¬í–‰**ì€ ì‹¤ì‹œê°„ í™˜ìœ¨ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì ì˜ ì—¬í–‰ì§€ë¥¼ ì¶”ì²œí•´ì£¼ëŠ” ëª¨ë°”ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì˜ˆì‚°ê³¼ ì—¬í–‰ ìŠ¤íƒ€ì¼ì— ë”°ë¼ ê²½ì œì ìœ¼ë¡œ ì—¬í–‰í•  ìˆ˜ ìˆëŠ” ë‚˜ë¼ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤. ë˜í•œ, ì—¬í–‰ ê´€ë ¨ ê²Œì‹œíŒì„ í†µí•´ ì—¬í–‰ ì •ë³´ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ’¡ í”„ë¡œì íŠ¸ ëª©í‘œ

> **"í™˜ìœ¨ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬, ëˆ„êµ¬ë‚˜ ê²½ì œì ìœ¼ë¡œ ì—¬í–‰í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì„œë¹„ìŠ¤"**
> 
## ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥

### ğŸ“Š í™˜ìœ¨ ì¡°íšŒ ë° ì‹œê°í™”
- ì™¸ë¶€ APIë¥¼ í†µí•´ **ì‹¤ì‹œê°„ í™˜ìœ¨ ë°ì´í„°** ë¶ˆëŸ¬ì™€ ì €ì¥ ë° ê´€ë¦¬
- **í™˜ìœ¨ ë³€ë™ ê·¸ë˜í”„**ë¡œ ìµœê·¼ í•˜ë£¨, 1ì£¼, 3ê°œì›”, 1ë…„, ì „ì²´ í™˜ìœ¨ ë³€ë™ í™•ì¸ ê°€ëŠ¥

### ğŸ“ ì—¬í–‰ ì •ë³´ ê³µìœ  (ê²Œì‹œíŒ ê¸°ëŠ¥)
- **ì—¬í–‰ í›„ê¸° ë° ì •ë³´ ê²Œì‹œê¸€ ì‘ì„± ê°€ëŠ¥**
- **ë‚˜ë¼ë³„ ê²Œì‹œê¸€ ì¡°íšŒ ê¸°ëŠ¥**
- **ë‹¨ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì§€ì› (S3 Presigned URL í™œìš©)**
- **ì¢‹ì•„ìš” ë° ëŒ“ê¸€ ê¸°ëŠ¥ ì§€ì›**

### í™˜ìœ¨ ê³„ì‚°ê¸°
- ì‹¤ì‹œê°„ í™˜ìœ¨ì„ ì´ìš©í•˜ì—¬ í†µí™”ê°„ ê³„ì‚°

### ğŸ“ êµ­ê°€ ë° í†µí™” ë°ì´í„° ê´€ë¦¬
- **êµ­ê°€ ë° í†µí™” ë°ì´í„°ë¥¼ ì •ì  íŒŒì¼ + DBë¡œ ê´€ë¦¬**
- API ìš”ì²­ ìµœì†Œí™”ë¥¼ ìœ„í•´ **í”„ë¡ íŠ¸ì—ì„œ ìºì‹±(React Context/AsyncStorage) ì ìš©**

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### ğŸ“± Frontend (React Native + Expo)
- **React Native / Expo**: ëª¨ë°”ì¼ ì•± ê°œë°œ (ios)
- **Expo Router**: ë„¤ë¹„ê²Œì´ì…˜ ë° ë¼ìš°íŒ… ê´€ë¦¬
- **Axios**: API ìš”ì²­ ê´€ë¦¬
- **React Context / AsyncStorage**: ê¸€ë¡œë²Œ ìƒíƒœ ë° ìºì‹±

### ğŸ”§ Backend (Spring Boot)
- **Spring Boot 3**: API ì„œë²„ ê°œë°œ
- **Spring Data JPA**: ë°ì´í„°ë² ì´ìŠ¤ ORM
- **Spring Security + JWT**: ì¸ì¦ ë° ë³´ì•ˆ
- **MySQL**: ë°ì´í„° ì €ì¥ ë° ê´€ë¦¬
- **Redis**: ìºì‹± ë° ì„¸ì…˜ ê´€ë¦¬

### ğŸš€ DevOps & Infra
- **AWS S3 + CloudFront**: ì´ë¯¸ì§€ ì €ì¥ ë° ìºì‹±, CDN ì‚¬ìš©

---

## ğŸ— í”„ë¡œì íŠ¸ êµ¬ì¡°

### í´ë” êµ¬ì¡°
```
nowtrip/
â”œâ”€â”€ frontend/    # React Native ê¸°ë°˜ ëª¨ë°”ì¼ ì•±
â”œâ”€â”€ backend/     # Spring Boot ê¸°ë°˜ API ì„œë²„
â””â”€â”€ README.md    # í”„ë¡œì íŠ¸ ì„¤ëª… íŒŒì¼
```

### ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°
![Image](https://github.com/user-attachments/assets/12b86806-70bc-4eca-8f44-3f89e2f0e9c7)

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ğŸ”¹ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- `frontend/.env`
- Expoë¥¼ ì‚¬ìš©í•œë‹¤ë©´ `EXPO_PUBLIC_[NAME]=VALUE` í˜•ì‹ì„ ê°–ì¶°ì•¼ í•¨
```env
EXPO_PUBLIC_API_URL = http://localhost:8080/api
EXPO_PUBLIC_CDN_FLAG_URL = https://<your-domain>.cloudfront.net/flags
```

- `resources/application.yml`
```yaml
spring:
  application:
    name: nowtrip
    # MySql ì„¤ì •
  datasource:
    url: jdbc:mysql://localhost:3306/nowtrip
    username: your-username
    password: your-password
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: create
    show-sql: true
    properties:
      hibernate.dialect: org.hibernate.dialect.MySQL8Dialect
    defer-datasource-initialization: true # JPAê°€ í…Œì´ë¸” ìƒì„± í›„ data.sql ì‹¤í–‰

  sql:
    init:
      mode: always # data.sql ì‹¤í–‰

# redis ì„¤ì •
  data:
    redis:
      host: localhost
      port: 6379

# AWS ì„¤ì •
cloud:
  aws:
    s3:
      bucket: your-bucket
    credentials:
      access-key: your-access-key
      secret-key: your-secret-key
    region:
      static: ap-northeast-2
    stack:
      auto: false
cloudfront:
  domain: https://<your-domain>.cloudfront.net

# JWT secret-key
jwt:
  secret:
    key: your-secret-key

# https://www.exchangerate-api.com ì—ì„œ ë°œê¸‰
exchange:
  apikey: your-apikey
```

### ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤
- brewë¥¼ í†µí•´ redisì™€ mysql ì„¤ì¹˜ í›„
- ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ í™œì„±í™”
```bash
brew services start redis
brew services start mysql
```
- mysql ì„œë²„ ì ‘ì† í›„ `nowtrip` database ìƒì„±
```bash
mysql -u root -p
CREATE DATABASE nowtrip;
```

### ğŸ”¹ Frontend (Expo)
- React Native Expo ì„¤ì¹˜ í›„ VSCì—ì„œ ì‹¤í–‰
```bash
cd frontend
npm ci
npx expo start
```

### ğŸ”¹ Backend (Spring Boot)
- Intellij IDEë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ì§ì ‘ ì‹¤í–‰
```bash
cd backend
./gradlew bootRun
```

---

## ğŸ“Œ ì£¼ìš” API

### ğŸ”¹ êµ­ê°€ ë° í†µí™” ë°ì´í„° API
- `/api/countries` : ëª¨ë“  êµ­ê°€ ë°ì´í„° ë°˜í™˜
- `/api/currencies` : ëª¨ë“  í†µí™” ë°ì´í„° ë°˜í™˜

### ğŸ”¹ í™˜ìœ¨ ë°ì´í„° API
- `GET: /api/exchange/list` : ìµœì‹  í™˜ìœ¨ ë°ì´í„° ì¡°íšŒ
- `GET: /api/exchange/history` : íŠ¹ì • í†µí™”ì˜ ê³¼ê±° í™˜ìœ¨ ë³€ë™ ì¡°íšŒ

### ğŸ”¹ ê²Œì‹œíŒ API
- `GET: /api/posts` : ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
- `GET: /api/posts/{postId}` : íŠ¹ì • ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ
- `POST: /api/posts` : ê²Œì‹œê¸€
- `POST: /api/posts/{postId}/like-toggle` : ê²Œì‹œê¸€ ì¢‹ì•„ìš” í† ê¸€ ê¸°ëŠ¥

---

## ğŸ“Œ ì„±ëŠ¥ í–¥ìƒì 

### ğŸ”¹ êµ­ê°€ ë° í†µí™” ë°ì´í„° API
ë©”ì¸ í˜ì´ì§€ì˜ APIëŠ” ì•„ë˜ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜:  
{ í†µí™” ì½”ë“œ, êµ­ê¸° ì½”ë“œ, í†µí™” í•œêµ­ ì´ë¦„, í†µí™” ê¸°í˜¸, í˜„ì¬ í™˜ìœ¨, ì–´ì œ ëŒ€ë¹„ í˜„ì¬ ì¦ê°ë¥  }

<ë©”ì¸ í˜ì´ì§€>  
<img src="https://github.com/user-attachments/assets/5f26d868-6822-4c7f-a55e-79ace9f64083" width="200"  />

#### ğŸ”¹ **ê¸°ì¡´ ë°©ì‹ (JPA í™œìš©)**
ê¸°ì¡´ì—ëŠ” JPAë¥¼ í™œìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì•¼ í–ˆìŒ:
```java
public List<ExchangeListResponse> getExchangeRateList() {
    LocalDate latestDate = exchangeRateRepository.findMaxLastUpdated();
    LocalDate previousDate = exchangeRateRepository.findPreviousLastUpdated(latestDate);
    
    List<ExchangeRate> todayRates = exchangeRateRepository.findByLastUpdated(latestDate);
    List<ExchangeRate> yesterdayRates = exchangeRateRepository.findByLastUpdated(previousDate);
    ...
    ...
}
```
âŒ ì´ë ‡ê²Œ í•˜ë©´ ì¿¼ë¦¬ê°€ ìµœì†Œ 4ê°œ ì´ìƒì´ ë˜ë©´ì„œ í‰ê·  ì‘ë‹µ ì‹œê°„ **ì•½ 500ms ì†Œìš”**

#### ğŸ”¹ **ê°œì„  í›„ (ë„¤ì´í‹°ë¸Œ SQL ì ìš©)**
í•˜ë‚˜ì˜ SQLë¡œ ìµœì‹  í™˜ìœ¨ê³¼ ì´ì „ í™˜ìœ¨ì„ í•œ ë²ˆì— ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ ì ìš©:
```java
@Query(value = """
    WITH today AS (
        SELECT e.target_currency, e.exchange_rate AS today_rate, e.last_updated
        FROM exchange_rate e
        WHERE e.last_updated = (SELECT MAX(last_updated) FROM exchange_rate)
    ),
    yesterday AS (
        SELECT e.target_currency, e.exchange_rate AS yesterday_rate, e.last_updated
        FROM exchange_rate e
        WHERE e.last_updated = (SELECT MAX(last_updated) FROM exchange_rate WHERE last_updated < (SELECT MAX(last_updated) FROM exchange_rate))
    )
    SELECT 
        t.target_currency AS currency,
        c.currency_flag_code AS flagCode,
        c.korean_name AS koreanName,
        c.symbol AS symbol,
        t.today_rate AS todayRate,
        y.yesterday_rate AS yesterdayRate,
        CASE 
            WHEN y.yesterday_rate = 0 THEN 0 
            ELSE ((t.today_rate - y.yesterday_rate) / y.yesterday_rate) * 100 
        END AS changeRate
    FROM today t
    JOIN yesterday y ON t.target_currency = y.target_currency
    JOIN currency c ON t.target_currency = c.code
    ORDER BY changeRate DESC
    """,
        nativeQuery = true)
List<Object[]> findTopChangedRates();
```

âœ… ê·¸ ê²°ê³¼, ì¿¼ë¦¬ ìˆ˜ë¥¼ 4ê°œ -> 1ê°œë¡œ ì¤„ì˜€ê³ , í‰ê·  ì‘ë‹µ ì‹œê°„ì´ **ì•½ 200msë¡œ ì„±ëŠ¥ 60% í–¥ìƒ**  
âœ… ì´ì²˜ëŸ¼ ë³µì¡í•œ ì‘ì—…ì´ ìˆëŠ” ê²½ìš°ì—” JPAë§Œì´ ì•„ë‹Œ ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ëŠ”ê²Œ ìƒì‚°ì  (JPQL, ë„¤ì´í‹°ë¸Œ SQL ë“±ë“±)

---

### ğŸ”¹ ì´ë¯¸ì§€ ì—…ë¡œë“œ

#### ğŸ”¹ ê¸°ì¡´ ë°©ì‹: (ë°ì´í„°ë² ì´ìŠ¤ì— ì´ë¯¸ì§€ ì €ì¥)
âŒ ê¸°ì¡´ì—ëŠ” ì´ë¯¸ì§€ë¥¼ Base64(`MultiartFile`ë¡œ ë³€í™˜í•˜ì—¬ DBì— ì €ì¥í•˜ëŠ” ë°©ì‹ì„ ê³ ë ¤í•˜ì˜€ìœ¼ë‚˜,  
âŒ íŒŒì¼ì˜ í¬ê¸°ë•Œë¬¸ì— ì—…, ë‹¤ìš´ë¡œë“œì˜ ì†ë„ê°€ ì €í•˜ê°€ ì¼ì–´ë‚˜ ì„œë²„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì´ ëŒ€í­ ì¦ê°€í–ˆìŒ

#### ğŸ”¹ ê°œì„  í›„ (AWS S3 + Cloudfront í™œìš©)
- ì´ë¯¸ì§€ ì—…ë¡œë“œ -> S3ì— ì—…ë¡œë“œ  
- ì´ë¯¸ì§€ ì œê³µ -> Cloudfrontì˜ CDN ìºì‹±

âœ… í´ë¼ì´ì–¸íŠ¸ -> API ì„œë²„ê°€ Presigned Url ë°˜í™˜ -> í´ë¼ì´ì–¸íŠ¸ê°€ S3ì— PUTìš”ì²­(ì—…ë¡œë“œ) -> ë°ì´í„°ë² ì´ìŠ¤ì— CloudFront ë„ë©”ì¸ ì €ì¥  
âœ… ì´ë¯¸ì§€ëŠ” Cloudfront ë„ë©”ì¸ì„ í†µí•´ ì œê³µ  
âœ… ì´ ë°©ì‹ì€ APIì„œë²„ì™€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë¶€í•˜ë¥¼ ëŒ€í­ ê°ì†Œ ì‹œí‚´ (Presigned Urlë§Œ ë°˜í™˜)  
âœ… ê·¸ ê²°ê³¼, ì´ë¯¸ì§€ í¬ê¸°ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ í‰ê·  ì—…ë¡œë“œ, ë‹¤ìš´ë¡œë“œì˜ ì„±ëŠ¥ì´ 80% í–¥ìƒ 

---

## ğŸ“Œ í–¥í›„ ê°œì„  ì‚¬í•­

- **ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ê°œì„ ** (ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ì¶”ì²œ ì ìš© ê°€ëŠ¥)
- **ìœ ì €ë³„ ê´€ì‹¬ ì—¬í–‰ì§€ ì €ì¥ ë° ë§ì¶¤ ì¶”ì²œ**  
- **í™˜ìœ¨ ë³€ë™ ë¶„ì„ ë° ì˜ˆì¸¡ ê¸°ëŠ¥ ì¶”ê°€**  
- **ë‹¤êµ­ì–´ ì§€ì› (í•œêµ­ì–´, ì˜ì–´, ì¼ë³¸ì–´ ë“±)**

---

## ë¬¸ì˜

ì´ í”„ë¡œì íŠ¸ì— ë¬¸ì˜ ì‚¬í•­ì´ ìˆë‹¤ë©´ **ì´ìŠˆ(issue) ë“±ë¡** ë˜ëŠ” **PR(Pull Request) ì œì¶œ**í•´ì£¼ì„¸ìš”.

**ğŸ“§ Contact:** chosh0206@naver.com

---


